info:
    app: Jboss
    name: CVE-2017-7504
    author: lz520520
    plugin_version: 1.0.0
    disclosure_date: "2017-04-05"
    create_date: "2024-10-06 07:46:58"
    update_date: "2024-10-06 07:46:58"
    scope: JBoss AS 4.x及之前版本
    description: Red Hat JBoss Application Server 是一款基于JavaEE的开源应用服务器。JBoss AS 4.x及之前版本中，JbossMQ实现过程的JMS over HTTP Invocation Layer的HTTPServerILServlet.java文件存在反序列化漏洞，远程攻击者可借助特制的序列化数据利用该漏洞执行任意代码。
    vul_id: CVE-2017-7504
    detail: |-
        1. 确认目标是否存在/jbossmq-httpil/HTTPServerILServlet 路径。
        2. 设置URL为http://x.x.x.x:8084或http://x.x.x.x:8084/jbossmq-httpil/HTTPServerILServlet
        2. 选择ysoserial的gadget，推荐使用CommonsCollectionsK1，对应版本commons-collections:3.2.1
        3. 输入命令执行即可。
        报错回显
    payload: POST提交的body部分为序列化对象，不可读
payloads:
    - name: cmd1
      alias: RCE
      params:
          - key: cmd
            title: 命令
            param_type: edit
            default_value: whoami
            required: true
          - key: gadget
            title: Gadget
            param_type: combobox
            default_value:
                - CommonsCollectionsK1ErrorEcho
                - CommonsCollectionsK2ErrorEcho
            required: true
